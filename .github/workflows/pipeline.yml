name: CI/CD Pipeline

on:
  push:
    branches:
      - main
  pull_request:
  workflow_dispatch:

jobs:
  pipeline:
    uses: bb-claw/ci-workflows/.github/workflows/full-pipeline.yml@v1
    with:
      dev-url: ${{ vars.DEV_URL }}
      prod-url: ${{ vars.PROD_URL }}
      railway-service-id-dev: ${{ vars.RAILWAY_SERVICE_ID_DEV }}
      railway-service-id-prod: ${{ vars.RAILWAY_SERVICE_ID_PROD }}
      dockerfile: ./Dockerfile
      health-check-path: /health
      integration-test-command: bash scripts/integration-tests.sh
      unit-test-command: npm run smoke
    secrets: inherit
